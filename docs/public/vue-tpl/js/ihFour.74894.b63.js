(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ihFour.74894"],{"0082":function(e,t,n){n.d(t,"a",(function(){return c}));const i=new Uint8Array([0,255,255,255]),r={pickingSelectedColor:null,pickingHighlightColor:i,pickingActive:!1,pickingAttribute:!1};function s(e=r){const t={};if(void 0!==e.pickingSelectedColor)if(e.pickingSelectedColor){const n=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}else t.picking_uSelectedColorValid=0;if(e.pickingHighlightColor){const n=Array.from(e.pickingHighlightColor,e=>e/255);Number.isFinite(n[3])||(n[3]=1),t.picking_uHighlightColor=n}return void 0!==e.pickingActive&&(t.picking_uActive=Boolean(e.pickingActive),t.picking_uAttribute=Boolean(e.pickingAttribute)),t}const o="uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",a="uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",c={name:"picking",vs:o,fs:a,getUniforms:s}},"1d2c":function(e,t,n){n.d(t,"a",(function(){return s}));let i=1,r=1;class s{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=i++,a={time:0,delay:t,duration:n,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:e,channel:t}=i;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=r++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}},"1e88":function(e,t,n){(function(e){var t=n("26b5"),i=n("5729"),r=n("3f90");function s(e){e.luma=e.luma||{};const{luma:n}=e;return n.polyfilled||(Object(t["a"])(e),a(e),l(e,r["b"]),c(e,{target:n,target2:e}),n.polyfilled=!0),e}const o="undefined"!==typeof e?e:window;function a(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}function c(e,{target:t,target2:n}){Object.keys(r["a"]).forEach(i=>{if("function"===typeof r["a"][i]){const s=e[i]?e[i].bind(e):()=>{},o=r["a"][i].bind(null,e,s);t[i]=o,n[i]=o}})}function l(e,t){for(const n of Object.getOwnPropertyNames(t))"overrides"!==n&&u(e,{extension:n,target:e.luma,target2:e})}function u(e,{extension:t,target:n,target2:s}){const o=r["b"][t];Object(i["a"])(o);const{meta:a={}}=o,{suffix:c=""}=a,l=e.getExtension(t);for(const i of Object.keys(o)){const t="".concat(i).concat(c);let r=null;"meta"===i||"function"===typeof e[i]||(l&&"function"===typeof l[t]?r=(...e)=>l[t](...e):"function"===typeof o[i]&&(r=o[i].bind(n))),r&&(n[i]=r,s[i]=r)}}o.polyfillContext=s}).call(this,n("c8ba"))},2:function(e,t){},"26b5":function(e,t,n){n.d(t,"a",(function(){return d}));var i=n("c526");const r={};function s(e){i["global"].console&&i["global"].console.error&&i["global"].console.error(e)}function o(e){i["global"].console&&i["global"].console.log&&i["global"].console.log(e)}function a(e,t){r[e]=!0,void 0!==t&&s(t)}function c(e){const t=e.getError;e.getError=function(){let n;do{n=t.apply(e),0!==n&&(r[n]=!0)}while(0!==n);for(n in r)if(r[n])return delete r[n],parseInt(n,10);return 0}}const l=function e(t){const n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const t=new e.VertexAttrib(n);this.attribs[i]=t}this.maxAttrib=0};l.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},l.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const u=function(e){const t=this;this.gl=e,c(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const i=t.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,e);const r=i.attribs[e];return r.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const i=t.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,e);const r=i.attribs[e];return r.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,i){switch(e){case 34962:t.currentArrayBuffer=i;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=i;break;default:}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,i){const r=t.currentVertexArrayObject,s=r.attribs[e];switch(i){case 34975:return s.buffer;case 34338:return s.enabled;case 34339:return s.size;case 34340:return s.stride;case 34341:return s.type;case 34922:return s.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,i,r,s,o,a){const c=t.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,e);const l=c.attribs[e];return l.buffer=t.currentArrayBuffer,l.size=i,l.type=r,l.normalized=s,l.stride=o,l.offset=a,l.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{o("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};function d(e){if("function"===typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const n=e.getExtension;e.getExtension=function(t){const i=n.call(this,t);return i||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new u(this)),this.__OESVertexArrayObject))}}u.prototype.VERTEX_ARRAY_BINDING_OES=34229,u.prototype.reset_=function(){const e=void 0!==this.vertexArrayObjects;if(e)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new l(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},u.prototype.createVertexArrayOES=function(){const e=new l(this);return this.vertexArrayObjects.push(e),e},u.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},u.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof l&&e.hasBeenBound&&e.ext===this)},u.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void a(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const r=this.currentVertexArrayObject;if(i===r)return;i&&r.elementArrayBuffer===i.elementArrayBuffer||n.bindBuffer.call(t,34963,r.elementArrayBuffer);let s=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,r.maxAttrib);for(let a=0;a<=o;a++){const e=r.attribs[a],o=i?i.attribs[a]:null;if(i&&e.enabled===o.enabled||(e.enabled?n.enableVertexAttribArray.call(t,a):n.disableVertexAttribArray.call(t,a)),e.enabled){let r=!1;i&&e.buffer===o.buffer||(s!==e.buffer&&(n.bindBuffer.call(t,34962,e.buffer),s=e.buffer),r=!0),(r||e.cached!==o.cached)&&n.vertexAttribPointer.call(t,a,e.size,e.type,e.normalized,e.stride,e.offset)}}this.currentArrayBuffer!==s&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)}},"3f90":function(e,t,n){n.d(t,"b",(function(){return L})),n.d(t,"a",(function(){return j}));var i=n("5729"),r=n("a093");const s="OES_element_index",o="WEBGL_draw_buffers",a="EXT_disjoint_timer_query",c="EXT_disjoint_timer_query_webgl2",l="EXT_texture_filter_anisotropic",u="WEBGL_debug_renderer_info",d=35723,h=4352,f=36795,g=34047,m=37445,p=37446,b=e=>Object(r["e"])(e)?void 0:0,_={[3074]:e=>Object(r["e"])(e)?void 0:36064,[d]:e=>Object(r["e"])(e)?void 0:h,[35977]:b,[32937]:b,[f]:(e,t)=>{const n=Object(r["e"])(e)?e.getExtension(c):e.getExtension(a);return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},[m]:(e,t)=>{const n=e.getExtension(u);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[p]:(e,t)=>{const n=e.getExtension(u);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[g]:(e,t)=>{const n=e.luma.extensions[l];return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:b,[35071]:b,[37447]:b,[36063]:(e,t)=>{if(!Object(r["e"])(e)){const n=e.getExtension(o);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:b,[35374]:b,[35377]:b,[34852]:e=>{if(!Object(r["e"])(e)){const t=e.getExtension(o);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:e=>e.getExtension(s)?2147483647:65535,[33001]:e=>e.getExtension(s)?16777216:65535,[33e3]:e=>16777216,[37157]:b,[35373]:b,[35657]:b,[36183]:b,[37137]:b,[34045]:b,[35978]:b,[35979]:b,[35968]:b,[35376]:b,[35375]:b,[35659]:b,[37154]:b,[35371]:b,[35658]:b,[35076]:b,[35077]:b,[35380]:b};function v(e,t,n){const i=_[n],r="function"===typeof i?i(e,t,n):i,s=void 0!==r?r:t(n);return s}const x="OES_vertex_array_object",y="ANGLE_instanced_arrays",A="WEBGL_draw_buffers",E="EXT_disjoint_timer_query",O="EXT_texture_filter_anisotropic",w="VertexArray requires WebGL2 or OES_vertex_array_object extension";function C(e,t){return{webgl2:Object(r["e"])(e),ext:e.getExtension(t)}}const L={[x]:{meta:{suffix:"OES"},createVertexArray:()=>{Object(i["a"])(!1,w)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[y]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){Object(i["a"])(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[A]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Object(i["a"])(!1)}},[E]:{meta:{suffix:"EXT"},createQuery:()=>{Object(i["a"])(!1)},deleteQuery:()=>{Object(i["a"])(!1)},beginQuery:()=>{Object(i["a"])(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},j={readBuffer:(e,t,n)=>{Object(r["e"])(e)&&t(n)},getVertexAttrib:(e,t,n,i)=>{const{webgl2:r,ext:s}=C(e,y);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0;break;default:}return void 0!==o?o:t(n,i)},getProgramParameter:(e,t,n,i)=>{if(!Object(r["e"])(e))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0;default:}return t(n,i)},getInternalformatParameter:(e,t,n,i,s)=>{if(!Object(r["e"])(e))switch(s){case 32937:return new Int32Array([0]);default:}return e.getInternalformatParameter(n,i,s)},getTexParameter(e,t,n,i){switch(i){case 34046:const{extensions:t}=e.luma,n=t[O];i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046;break;default:}return t(n,i)},getParameter:v,hint(e,t,n,i){return t(n,i)}}},"4ea4":function(e,t){function n(e){return e&&e.__esModule?e:{default:e}}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},5729:function(e,t,n){function i(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}n.d(t,"a",(function(){return i}))},8177:function(e,t,n){n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d}));var i=n("ae9d"),r=n("f50d"),s=n("5729"),o=n("a093"),a=n("dd22");function c(e,t){if(Object(s["a"])(Object(o["d"])(e),"setParameters requires a WebGL context"),Object(a["b"])(t))return;const n={};for(const s in t){const r=Number(s),o=i["e"][s];o&&("string"===typeof o?n[o]=!0:o(e,t[s],r))}const r=e.state&&e.state.cache;if(r)for(const s in n){const n=i["a"][s];n(e,t,r)}}function l(e,t){if(t=t||i["c"],"number"===typeof t){const n=t,r=i["d"][n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const s of n){const t=i["d"][s];r[s]=t?t(e,Number(s)):e.getParameter(Number(s))}return r}function u(e){c(e,i["c"])}function d(e,t,n){if(Object(a["b"])(t))return n(e);const{nocatch:i=!0}=t;let s;if(Object(r["b"])(e),c(e,t),i)s=n(e),Object(r["a"])(e);else try{s=n(e)}finally{Object(r["a"])(e)}return s}},"850d":function(e,t,n){n.d(t,"a",(function(){return h}));var i=n("89e8"),r=n("aed6"),s=n("0b1c"),o=n("45f7"),a=n("3198"),c=n("d752"),l=n("c526");const u=Object(l["isBrowser"])()&&"undefined"!==typeof document;let d=0;class h{constructor(e={}){const{onCreateContext:t=(e=>Object(i["c"])(e)),onAddHTML:n=null,onInitialize:s=(()=>{}),onRender:o=(()=>{}),onFinalize:a=(()=>{}),onError:c,gl:l=null,glOptions:u={},debug:h=!1,createFramebuffer:f=!1,autoResizeViewport:g=!0,autoResizeDrawingBuffer:m=!0,stats:p=r["a"].get("animation-loop-".concat(d++))}=e;let{useDevicePixels:b=!0}=e;"useDevicePixelRatio"in e&&(i["i"].deprecated("useDevicePixelRatio","useDevicePixels")(),b=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:s,onRender:o,onFinalize:a,onError:c,gl:l,glOptions:u,debug:h,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:g,autoResizeDrawingBuffer:m,useDevicePixels:b}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Object(s["a"])("string"===typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=o["a"].isSupported(this.gl,["timers"])?new o["a"](this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),Object(a["a"])(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return i["i"].removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};Object(a["a"])(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=u?new Promise((e,t)=>{u&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(e){this.display&&this.display.requestAnimationFrame(e)||Object(a["b"])(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"===typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!==typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Object(i["f"])(this.props.gl,e):this.onCreateContext(e),!Object(i["g"])(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(i["j"])(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Object(i["k"])(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new c["a"](this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}},"85aa":function(e,t,n){n.d(t,"a",(function(){return ge}));const i="vs",r="fs";function s(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const o={number:{validate(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},array:{validate(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function a(e){const t={};for(const n in e){const i=e[n],r=c(i);t[n]=r}return t}function c(e){let t=l(e);return"object"===t?e?"type"in e?Object.assign({},e,o[e.type]):"value"in e?(t=l(e.value),Object.assign({type:t},e,o[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},o[t])}function l(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const u="vs",d="fs";class h{constructor({name:e,vs:t,fs:n,dependencies:i=[],uniforms:r,getUniforms:o,deprecations:c=[],defines:l={},inject:u={},vertexShader:d,fragmentShader:h}){s("string"===typeof e),this.name=e,this.vs=t||d,this.fs=n||h,this.getModuleUniforms=o,this.dependencies=i,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=f(u),r&&(this.uniforms=a(r))}getModuleSource(e){let t;switch(e){case u:t=this.vs||"";break;case d:t=this.fs||"";break;default:s(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())})}_parseDeprecationDefinitions(e){return e.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),e}_defaultGetUniforms(e={}){const t={},n=this.uniforms;for(const i in n){const r=n[i];i in e&&!r.private?(r.validate&&s(r.validate(e[i],r),"".concat(this.name,": invalid ").concat(i)),t[i]=e[i]):t[i]=r.value}return t}}function f(e){const t={vs:{},fs:{}};for(const n in e){let i=e[n];const r=n.slice(0,2);"string"===typeof i&&(i={order:0,injection:i}),t[r][n]=i}return t}function g(e){return m(b(e))}function m(e){const t={},n={};return p({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e])}function p({modules:e,level:t,moduleMap:n,moduleDepth:i}){if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const r of e)n[r.name]=r,(void 0===i[r.name]||i[r.name]<t)&&(i[r.name]=t);for(const r of e)r.dependencies&&p({modules:r.dependencies,level:t+1,moduleMap:n,moduleDepth:i})}function b(e,t){return e.map(e=>(e instanceof h||(s("string"!==typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),s(e.name,"shader module has no name"),e=new h(e),e.dependencies=b(e.dependencies)),e))}function _(e={}){const t="undefined"!==typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}const v=7936,x=7937,y=7938,A=35724,E={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},O={};function w(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function C(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||v),i=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||x),r=L(n,i),s={gpuVendor:r,vendor:n,renderer:i,version:e.getParameter(y),shadingLanguageVersion:e.getParameter(A)};return s}function L(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(E).forEach(e=>{O[e]=e});const j={};function M(e,t,n={}){const i=E[t];if(s(i,t),!_(n))return!0;if(t in j)return j[t];const r=i[0],o=n.behavior||"enable",a="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),c=e.createShader(35633);e.shaderSource(c,a),e.compileShader(c);const l=e.getShaderParameter(c,35713);return e.deleteShader(c),j[t]=l,l}function P(e,t){const n=E[t];s(n,t);const i=w(e)&&n[1]||n[0],r="string"===typeof i?Boolean(e.getExtension(i)):i;return s(!1===r||!0===r),r}function R(e,t){return t=Array.isArray(t)?t:[t],t.every(t=>P(e,t))}function S(e){const t=C(e);switch(t.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}function F(e,t,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return R(e,O.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),R(e,O.GLSL_DERIVATIVES)&&M(e,O.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),R(e,O.GLSL_FRAG_DATA)&&M(e,O.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),R(e,O.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}const D="#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",T="#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n",k={[i]:D,[r]:T},I="__LUMA_INJECT_DECLARATIONS__",G=/void\s+main\s*\([^)]*\)\s*\{\n?/,B=/}\n?[^{}]*$/,V=[];function N(e,t,n,r=!1){const s=t===i;for(const i in n){const t=n[i];t.sort((e,t)=>e.order-t.order),V.length=t.length;for(let e=0,n=t.length;e<n;++e)V[e]=t[e].injection;const r="".concat(V.join("\n"),"\n");switch(i){case"vs:#decl":s&&(e=e.replace(I,r));break;case"vs:#main-start":s&&(e=e.replace(G,e=>e+r));break;case"vs:#main-end":s&&(e=e.replace(B,e=>r+e));break;case"fs:#decl":s||(e=e.replace(I,r));break;case"fs:#main-start":s||(e=e.replace(G,e=>e+r));break;case"fs:#main-end":s||(e=e.replace(B,e=>r+e));break;default:e=e.replace(i,e=>e+r)}}return e=e.replace(I,""),r&&(e=e.replace(/\}\s*$/,e=>e+k[t])),e}function U(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const W=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],z=[...W,[U("attribute"),"in $1"],[U("varying"),"out $1"]],H=[...W,[U("varying"),"in $1"]],X=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],q=[...X,[U("in"),"attribute $1"],[U("out"),"varying $1"]],Q=[...X,[U("in"),"varying $1"]],K="gl_FragColor",$=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Y=/void\s+main\s*\([^)]*\)\s*\{\n?/;function J(e,t,n){switch(t){case 300:return n?Z(e,z):ee(e);case 100:return n?Z(e,q):te(e);default:throw new Error("unknown GLSL version ".concat(t))}}function Z(e,t){for(const[n,i]of t)e=e.replace(n,i);return e}function ee(e){e=Z(e,H);const t=e.match($);if(t){const n=t[1];e=e.replace(new RegExp("\\b".concat(K,"\\b"),"g"),n)}else{const t="fragmentColor";e=e.replace(Y,e=>"out vec4 ".concat(t,";\n").concat(e)).replace(new RegExp("\\b".concat(K,"\\b"),"g"),t)}return e}function te(e){e=Z(e,Q);const t=e.match($);if(t){const n=t[1];e=e.replace($,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),K)}return e}const ne="\n\n".concat(I,"\n\n"),ie={[i]:"vertex",[r]:"fragment"},re="precision highp float;\n\n";function se(e,t){const{vs:n,fs:s}=t,o=g(t.modules||[]);return{gl:e,vs:oe(e,Object.assign({},t,{source:n,type:i,modules:o})),fs:oe(e,Object.assign({},t,{source:s,type:r,modules:o})),getUniforms:ae(o)}}function oe(e,{id:t,source:n,type:r,modules:o,defines:a={},hookFunctions:c=[],inject:l={},transpileToGLSL100:u=!1,prologue:d=!0,log:h}){s("string"===typeof n,"shader source must be a string");const f=r===i,g=n.split("\n");let m=100,p="",b=n;0===g[0].indexOf("#version ")?(m=300,p=g[0],b=g.slice(1).join("\n")):p="#version ".concat(m);const _={};o.forEach(e=>{Object.assign(_,e.getDefines())}),Object.assign(_,a);let v=d?"".concat(p,"\n").concat(le({id:t,source:n,type:r}),"\n").concat(ce({type:r}),"\n").concat(S(e),"\n").concat(F(e,m,!f),"\n").concat(ue(_),"\n").concat(f?"":re,"\n"):"".concat(p,"\n");const x=he(c),y={},A={},E={};for(const i in l){const e="string"===typeof l[i]?{injection:l[i],order:0}:l[i],t=i.match(/^(v|f)s:(#)?([\w-]+)$/);if(t){const n=t[2],r=t[3];n?"decl"===r?A[i]=[e]:E[i]=[e]:y[i]=[e]}else E[i]=[e]}for(const i of o){h&&i.checkDeprecations(b,h);const e=i.getModuleSource(r,m);v+=e;const t=i.injections[r];for(const n in t){const e=n.match(/^(v|f)s:#([\w-]+)$/);if(e){const i=e[2],r="decl"===i?A:E;r[n]=r[n]||[],r[n].push(t[n])}else y[n]=y[n]||[],y[n].push(t[n])}}return v+=ne,v=N(v,r,A),v+=de(x[r],y),v+=b,v=N(v,r,E),v=J(v,u?100:m,f),v}function ae(e){return function(t){const n={};for(const i of e){const e=i.getUniforms(t,n);Object.assign(n,e)}return n}}function ce({type:e}){return"\n#define SHADER_TYPE_".concat(ie[e].toUpperCase(),"\n")}function le({id:e,source:t,type:n}){const i=e&&"string"===typeof e&&-1===t.indexOf("SHADER_NAME");return i?"\n#define SHADER_NAME ".concat(e,"_").concat(ie[n],"\n\n"):""}function ue(e={}){let t=0,n="";for(const i in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const r=e[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(e[i],"\n"))}return 0===t&&(n+="\n"),n}function de(e,t){let n="";for(const i in e){const r=e[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),t[i]){const e=t[i];e.sort((e,t)=>e.order-t.order);for(const t of e)n+="  ".concat(t.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}function he(e){const t={vs:{},fs:{}};return e.forEach(e=>{let n;"string"!==typeof e?(n=e,e=n.hook):n={},e=e.trim();const[i,r]=e.split(":"),s=e.replace(/\(.+/,"");t[i][s]=Object.assign(n,{signature:r})}),t}var fe=n("3a49");class ge{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new ge(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:n="",defines:i={},inject:r={},varyings:s=[],bufferMode:o=35981,transpileToGLSL100:a=!1}=e,c=this._getModuleList(e.modules),l=this._getHash(t),u=this._getHash(n),d=c.map(e=>this._getHash(e.name)).sort(),h=s.map(e=>this._getHash(e)),f=Object.keys(i).sort(),g=Object.keys(r).sort(),m=[],p=[];for(const _ of f)m.push(this._getHash(_)),m.push(this._getHash(i[_]));for(const _ of g)p.push(this._getHash(_)),p.push(this._getHash(r[_]));const b="".concat(l,"/").concat(u,"D").concat(m.join("/"),"M").concat(d.join("/"),"I").concat(p.join("/"),"V").concat(h.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(a?"T":"");if(!this._programCache[b]){const e=se(this.gl,{vs:t,fs:n,modules:c,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[b]=new fe["a"](this.gl,{hash:b,vs:e.vs,fs:e.fs,varyings:s,bufferMode:o}),this._getUniforms[b]=e.getUniforms||(e=>{}),this._useCounts[b]=0}return this._useCounts[b]++,this._programCache[b]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let r=0,s=this._defaultModules.length;r<s;++r){const e=this._defaultModules[r],s=e.name;t[i++]=e,n[s]=!0}for(let r=0,s=e.length;r<s;++r){const s=e[r],o=s.name;n[o]||(t[i++]=s,n[o]=!0)}return t.length=i,t}}},"89e8":function(e,t,n){n.d(t,"i",(function(){return r})),n.d(t,"g",(function(){return s["d"]})),n.d(t,"h",(function(){return s["e"]})),n.d(t,"e",(function(){return s["c"]})),n.d(t,"b",(function(){return s["b"]})),n.d(t,"a",(function(){return s["a"]})),n.d(t,"l",(function(){return o["c"]})),n.d(t,"j",(function(){return o["b"]})),n.d(t,"m",(function(){return o["d"]})),n.d(t,"c",(function(){return v})),n.d(t,"k",(function(){return A})),n.d(t,"f",(function(){return x})),n.d(t,"d",(function(){return d}));var i=n("777c");const r=new i["a"]({id:"luma.gl"});var s=n("a093"),o=(n("1e88"),n("8177")),a=n("f50d"),c=n("c526"),l=n("5729");function u(e){const{luma:t}=e;if(e.canvas&&t){const{clientWidth:n}=t.canvasSizeInfo;return n?e.drawingBufferWidth/n:1}return 1}function d(e,t,n=!0){const i=u(e),r=e.drawingBufferWidth,s=e.drawingBufferHeight;return f(t,i,r,s,n)}function h(e){const t="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(e)?e<=0?1:e:e?t:1}function f(e,t,n,i,r){const s=g(e[0],t,n);let o=m(e[1],t,i,r),a=g(e[0]+1,t,n);const c=a===n-1?a:a-1;let l;return a=m(e[1]+1,t,i,r),r?(a=0===a?a:a+1,l=o,o=a):l=a===i-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(l-o+1,1)}}function g(e,t,n){const i=Math.min(Math.round(e*t),n-1);return i}function m(e,t,n,i){return i?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const p=Object(c["isBrowser"])(),b=p&&"undefined"!==typeof document,_={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function v(e={}){Object(l["a"])(p,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},_,e);const{width:t,height:n}=e;function i(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let r;e.onError=i;const{canvas:s}=e,o=O({canvas:s,width:t,height:n,onError:i});return r=E(o,e),r?(r=x(r,e),w(r),r):null}function x(e,t={}){if(!e||e._instrumented)return e;e._version=e._version||C(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},t=Object.assign({},_,t);const{manageState:n,debug:i}=t;return n&&Object(a["c"])(e,{copyState:!1,log:(...e)=>r.log(1,...e)()}),p&&i&&(c["global"].makeDebugContext?(e=c["global"].makeDebugContext(e,t),r.level=Math.max(r.level,1)):r.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function y(e){const t=e.getParameter(7936),n=e.getParameter(7937),i=e.getExtension("WEBGL_debug_renderer_info"),r=i&&e.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),s=i&&e.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||t,renderer:s||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}function A(e,t={}){if(e.canvas){const n=h(t.useDevicePixels);return void L(e,n,t)}const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}function E(e,t){const{onError:n}=t;let i=null;const r=e=>i=e.statusMessage||i;e.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=t;let a=null;return o&&(a=a||e.getContext("webgl2",t),a=a||e.getContext("experimental-webgl2",t)),s&&(a=a||e.getContext("webgl",t),a=a||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",r,!1),a?(t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function O({canvas:e,width:t=800,height:n=600,onError:i}){let r;if("string"===typeof e){const t=b&&"complete"===document.readyState;t||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),r=document.getElementById(e)}else e?r=e:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",r.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(r,document.body.firstChild));return r}function w(e){const t=Object(s["e"])(e)?"WebGL2":"WebGL1",n=y(e),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",o=e.debug?" debug":"";r.info(1,"".concat(t).concat(o," context ").concat(i))()}function C(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?2:1}function L(e,t,n){let i="width"in n?n.width:e.canvas.clientWidth,s="height"in n?n.height:e.canvas.clientHeight;i&&s||(r.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,i=e.canvas.width||1,s=e.canvas.height||1),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const o=e.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==s||o.devicePixelRatio!==t){let n=t;const o=Math.floor(i*n),a=Math.floor(s*n);e.canvas.width=o,e.canvas.height=a,e.drawingBufferWidth===o&&e.drawingBufferHeight===a||(r.warn("Device pixel ratio clamped")(),n=Math.min(e.drawingBufferWidth/i,e.drawingBufferHeight/s),e.canvas.width=Math.floor(i*n),e.canvas.height=Math.floor(s*n)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:i,clientHeight:s,devicePixelRatio:t})}}},a093:function(e,t,n){n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var i=n("5729");const r="Invalid WebGLRenderingContext",s="Requires WebGL2";function o(e){return"undefined"!==typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function a(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function c(e){return a(e)?e:null}function l(e){return Object(i["a"])(o(e),r),e}function u(e){return Object(i["a"])(a(e),s),e}},ae9d:function(e,t,n){n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return p}));var i=n("a093");const r={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},s=(e,t,n)=>t?e.enable(n):e.disable(n),o=(e,t,n)=>e.hint(n,t),a=(e,t,n)=>e.pixelStorei(n,t),c=(e,t)=>{const n=Object(i["e"])(e)?36009:36160;return e.bindFramebuffer(n,t)},l=(e,t)=>e.bindFramebuffer(36008,t);function u(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const d={[3042]:s,[32773]:(e,t)=>e.blendColor(...t),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(e,t)=>e.clearColor(...t),[3107]:(e,t)=>e.colorMask(...t),[2884]:s,[2885]:(e,t)=>e.cullFace(t),[2929]:s,[2931]:(e,t)=>e.clearDepth(t),[2932]:(e,t)=>e.depthFunc(t),[2928]:(e,t)=>e.depthRange(...t),[2930]:(e,t)=>e.depthMask(t),[3024]:s,[35723]:o,[36006]:c,[2886]:(e,t)=>e.frontFace(t),[33170]:o,[2849]:(e,t)=>e.lineWidth(t),[32823]:s,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:s,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:s,[3088]:(e,t)=>e.scissor(...t),[2960]:s,[2961]:(e,t)=>e.clearStencil(t),[2968]:(e,t)=>e.stencilMaskSeparate(1028,t),[36005]:(e,t)=>e.stencilMaskSeparate(1029,t),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(e,t)=>e.viewport(...t),[3333]:a,[3317]:a,[37440]:a,[37441]:a,[37443]:a,[3330]:a,[3332]:a,[3331]:a,[36010]:l,[3314]:a,[32878]:a,[3316]:a,[3315]:a,[32877]:a,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=u(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=u(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=u(t)?t:[t,t];const[n,i]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,i)},stencilFunc:(e,t)=>{t=u(t)&&3===t.length?[...t,...t]:t;const[n,i,r,s,o,a]=t;e.stencilFuncSeparate(1028,n,i,r),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=u(t)&&3===t.length?[...t,...t]:t;const[n,i,r,s,o,a]=t;e.stencilOpSeparate(1028,n,i,r),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function h(e,t,n){return void 0!==t[e]?t[e]:n[e]}const f={blendEquation:(e,t,n)=>e.blendEquationSeparate(h(32777,t,n),h(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(h(32969,t,n),h(32968,t,n),h(32971,t,n),h(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(h(32824,t,n),h(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(h(32938,t,n),h(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,h(2962,t,n),h(2967,t,n),h(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,h(34816,t,n),h(36003,t,n),h(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,h(2964,t,n),h(2965,t,n),h(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,h(34817,t,n),h(34818,t,n),h(34819,t,n))},g={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({[36006]:n,[36010]:n});case 36009:return e({[36006]:n});case 36008:return e({[36010]:n});default:return null}},blendColor:(e,t,n,i,r)=>e({[32773]:new Float32Array([t,n,i,r])}),blendEquation:(e,t)=>e({[32777]:t,[34877]:t}),blendEquationSeparate:(e,t,n)=>e({[32777]:t,[34877]:n}),blendFunc:(e,t,n)=>e({[32969]:t,[32968]:n,[32971]:t,[32970]:n}),blendFuncSeparate:(e,t,n,i,r)=>e({[32969]:t,[32968]:n,[32971]:i,[32970]:r}),clearColor:(e,t,n,i,r)=>e({[3106]:new Float32Array([t,n,i,r])}),clearDepth:(e,t)=>e({[2931]:t}),clearStencil:(e,t)=>e({[2961]:t}),colorMask:(e,t,n,i,r)=>e({[3107]:[t,n,i,r]}),cullFace:(e,t)=>e({[2885]:t}),depthFunc:(e,t)=>e({[2932]:t}),depthRange:(e,t,n)=>e({[2928]:new Float32Array([t,n])}),depthMask:(e,t)=>e({[2930]:t}),frontFace:(e,t)=>e({[2886]:t}),lineWidth:(e,t)=>e({[2849]:t}),polygonOffset:(e,t,n)=>e({[32824]:t,[10752]:n}),sampleCoverage:(e,t,n)=>e({[32938]:t,[32939]:n}),scissor:(e,t,n,i,r)=>e({[3088]:new Int32Array([t,n,i,r])}),stencilMask:(e,t)=>e({[2968]:t,[36005]:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,i)=>e({[2962]:t,[2967]:n,[2963]:i,[34816]:t,[36003]:n,[36004]:i}),stencilFuncSeparate:(e,t,n,i,r)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:i,[1028===t?2963:36004]:r}),stencilOp:(e,t,n,i)=>e({[2964]:t,[2965]:n,[2966]:i,[34817]:t,[34818]:n,[34819]:i}),stencilOpSeparate:(e,t,n,i,r)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:i,[1028===t?2966:34819]:r}),viewport:(e,t,n,i,r)=>e({[2978]:[t,n,i,r]})},m=(e,t)=>e.isEnabled(t),p={[3042]:m,[2884]:m,[2929]:m,[3024]:m,[32823]:m,[32926]:m,[32928]:m,[3089]:m,[2960]:m,[35977]:m}},c49b:function(e,t,n){n.d(t,"a",(function(){return p}));var i=n("370d");const r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s={modelMatrix:r,viewMatrix:r,projectionMatrix:r,cameraPositionWorld:[0,0,0]};function o(e=s,t={}){const n={};return void 0!==e.modelMatrix&&(n.modelMatrix=e.modelMatrix),void 0!==e.viewMatrix&&(n.viewMatrix=e.viewMatrix),void 0!==e.projectionMatrix&&(n.projectionMatrix=e.projectionMatrix),void 0!==e.cameraPositionWorld&&(n.cameraPositionWorld=e.cameraPositionWorld),void 0===e.projectionMatrix&&void 0===e.viewMatrix||(n.viewProjectionMatrix=new i["a"](e.projectionMatrix).multiplyRight(e.viewMatrix)),n}const a="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",c="".concat(a,"\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),l="\n".concat(a),u={name:"project",getUniforms:o,vs:c,fs:l},d=new Float32Array([1,1,2]),h={lightDirection:d};function f(e=h){const t={};return e.lightDirection&&(t.dirlight_uLightDirection=e.lightDirection),t}const g=null,m="uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",p={name:"dirlight",vs:g,fs:m,getUniforms:f,dependencies:[u]}},ca47:function(e,t,n){n.d(t,"a",(function(){return O}));var i=n("89e8"),r=n("85aa"),s=n("55da"),o=n("0b1c"),a=n("a511"),c=n("3a49"),l=n("a698"),u=n("b1cf"),d=n("6e98"),h=n("7aa2"),f=n("167a"),g=n("cf6e");const m={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function p(e,t,n){const i={};let r=t.indices;for(const s in t.attributes){const o=t.attributes[s],a=b(s,n);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const t=o.value,n={...o};delete n.value,i[a]=[new u["a"](e,t),n],_(s,n)}}if(r){const t=r.value||r;Object(o["a"])(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new u["a"](e,{data:t,target:34963}),n]}return i}function b(e,t){const{attributeMap:n=m}=t||{};return n&&n[e]||e}function _(e,t){let n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break;default:}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2;break;default:}Object(o["a"])(Number.isFinite(t.size),"attribute ".concat(e," needs size"))}const v=2,x=1e4,y="Model needs drawMode and vertexCount",A=()=>{},E={};class O{constructor(e,t={}){const{id:n=Object(s["c"])("model")}=t;Object(o["a"])(Object(i["g"])(e)),this.id=n,this.gl=e,this.id=t.id||Object(s["c"])("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||r["a"].getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:i,modules:s,defines:a,inject:c,varyings:l,bufferMode:u,transpileToGLSL100:d}=e;this.programProps={program:t,vs:n,fs:i,modules:s,defines:a,inject:c,varyings:l,bufferMode:u,transpileToGLSL100:d},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Object(o["a"])(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),y)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:i,modules:r,defines:s,inject:o,varyings:a,bufferMode:c,transpileToGLSL100:l}=e;this.programProps={program:t,vs:n,fs:i,modules:r,defines:s,inject:o,varyings:a,bufferMode:c,transpileToGLSL100:l},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Object(o["a"])(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Object(o["a"])(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=p(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Object(s["a"])(e))return this;const t={};for(const n in e){const i=e[n];t[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return Object(a["a"])(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;let l;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),i["i"].priority>=v&&(l=this._logDrawCallStart(v));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:g=u.isInstanced}=this.props;g&&!this.isInstanced&&i["i"].warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:m,instanceCount:p}=this,{onBeforeRender:b=A,onAfterRender:_=A}=this.props;b(),this.program.setUniforms(this.uniforms);const x=this.program.draw(Object.assign(E,e,{logPriority:l,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:d,indexType:h,isInstanced:m,instanceCount:p,offset:d?f:0}));return _(),i["i"].priority>=v&&this._logDrawCallEnd(l,c,n),x}transform(e={}){const{discard:t=!0,feedbackBuffers:n,unbindModels:i=[]}=e;let{parameters:r}=e;n&&this._setFeedbackBuffers(n),t&&(r=Object.assign({},r,{[35977]:t})),i.forEach(e=>e.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:r}))}finally{i.forEach(e=>e.vertexArray.bindBuffers())}return this}render(e={}){return i["i"].warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){const e=this._programDirty||this.programManager.stateHash!==this._programManagerState;if(!e)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:c}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Object(o["a"])(t instanceof c["a"],"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new l["a"](this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof u["a"]&&t.delete()}}_setAnimationProps(e){this.animated&&Object(o["a"])(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Object(s["a"])(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new d["a"](t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:x;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),i["i"].group(v,">>> DRAWING MODEL ".concat(this.id),{collapsed:i["i"].level<=2})(),e}_logDrawCallEnd(e,t,n,r){if(void 0===e)return;const s=Object(h["a"])({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=Object(f["a"])({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:u}=Object(f["a"])({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});u>0&&i["i"].log("MISSING UNIFORMS",Object.keys(l))(),c>0&&i["i"].log("UNUSED UNIFORMS",Object.keys(a))();const d=Object(g["a"])(this.vertexArray.configuration);i["i"].table(e,s)(),i["i"].table(e,o)(),i["i"].table(e+1,d)(),r&&r.log({logLevel:v,message:"Rendered to ".concat(r.id)}),i["i"].groupEnd(v,">>> DRAWING MODEL ".concat(this.id))()}}},dd22:function(e,t,n){function i(e){for(const t in e)return!1;return!0}function r(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),i=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&i&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}))},f50d:function(e,t,n){(function(e){n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var i=n("ae9d"),r=n("8177"),s=n("5729"),o=n("dd22");function a(e,t){const n=e[t].bind(e);e[t]=function(...t){const i=t[0];return i in e.state.cache||(e.state.cache[i]=n(...t)),e.state.enable?e.state.cache[i]:n(...t)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function c(e,t,n){const i=e[t].bind(e);e[t]=function(...t){const{valueChanged:r,oldValue:s}=n(e.state._updateCache,...t);return r&&i(...t),s},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function l(e){const t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}class u{constructor(e,{copyState:t=!1,log:n=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?Object(r["a"])(e):Object.assign({},i["c"]),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Object(s["a"])(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Object(r["c"])(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in e){Object(s["a"])(void 0!==r);const a=e[r],c=this.cache[r];Object(o["a"])(a,c)||(n=!0,t=c,i&&!(r in i)&&(i[r]=c),this.cache[r]=a)}return{valueChanged:n,oldValue:t}}}function d(t,n={}){const{enable:r=!0,copyState:o}=n;if(Object(s["a"])(void 0!==o),!t.state){const n="undefined"!==typeof e?e:window,{polyfillContext:r}=n;r&&r(t),t.state=new u(t,{copyState:o}),l(t);for(const e in i["b"]){const n=i["b"][e];c(t,e,n)}a(t,"getParameter"),a(t,"isEnabled")}return t.state.enable=r,t}function h(e){e.state||d(e,{copyState:!1}),e.state.push()}function f(e){Object(s["a"])(e.state),e.state.pop()}}).call(this,n("c8ba"))},f697:function(e,t,n){n.d(t,"a",(function(){return h}));var i=n("55da"),r=n("0b1c");const s={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class o{static get DRAW_MODE(){return s}constructor(e={}){const{id:t=Object(i["c"])("geometry"),drawMode:n=s.TRIANGLES,attributes:r={},indices:o=null,vertexCount:a=null}=e;this.id=t,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,o),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const n in e){let t=e[n];t=ArrayBuffer.isView(t)?{value:t}:t,Object(r["a"])(ArrayBuffer.isView(t.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||t.size||(t.size=3),"indices"===n?(Object(r["a"])(!this.indices),this.indices=t):this.attributes[n]=t}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const i in e){const t=e[i],{value:r,size:s,constant:o}=t;!o&&r&&s>=1&&(n=Math.min(n,r.length/s))}return Object(r["a"])(Number.isFinite(n)),n}}const a=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),c=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),l=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),u=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),d={POSITION:{size:3,value:new Float32Array(c)},NORMAL:{size:3,value:new Float32Array(l)},TEXCOORD_0:{size:2,value:new Float32Array(u)}};class h extends o{constructor(e={}){const{id:t=Object(i["c"])("cube-geometry")}=e;super({...e,id:t,indices:{size:1,value:new Uint16Array(a)},attributes:{...d,...e.attributes}})}}}}]);